<html>
<head>
	<title>Big Brother</title>
	<meta charset="utf-8" />
	<!--  Meta tags for sharing -->
	<!---->
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

	<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <style>

         /* Sticky footer styles
        -------------------------------------------------- */
				.mbutton {
					padding: 20px;
					margin: 15px;
					font-size: 18px;
					color: #dddddd;
					background-color: #444444;
				}
				.fpost {
					background-color: #ffffff;
					padding: 15px;
					margin: 10px;
					font-size: 20px;
				}
				.name {
					text-align: right;
					font-size: 16px;
				}
        html {
          position: relative;
          min-height: 100%;
        }
        .btn-primary {
            background-color: #252525;
        }
        body {
          /* Margin bottom by footer height */
          margin-bottom: 40px;
          font-family: 'Open Sans', sans-serif;
          overflow-x: hidden;
          background-color: #F1F3F1;
        }
        h5{
            font-family: 'Open Sans', sans-serif;
        }
        strong{
            font-family: 'Open Sans', sans-serif;
        }
        .box{
            border: 2px #BBB solid
        }
        .footer {
          overflow: hidden;
          position: absolute;
          bottom: 0;
          width: 100%;
          /* Set the fixed height of the footer here */
          height: 40px;
          background-color: #252525;
        }
    </style>
    <base href="/">
</head>
<body ng-app="mainApp">
  <script>
    // This is called with the results from from FB.getLoginStatus().
		function setCookie( name, value, days, path ) {
		  var date = new Date();
		  date.setTime( date.getTime() + ( days*24*60*60*1000 ) );
		  var expires = "; expires=" + date.toGMTString();
		  document.cookie = name + '=' + value + expires + '; path=' + path;
		}

		function readCookie(cookieName) {
		  var theCookie=""+document.cookie;
		  var ind=theCookie.indexOf(cookieName);
		  if (ind==-1 || cookieName=="") return "";
		  var ind1=theCookie.indexOf(';',ind);
		  if (ind1==-1) ind1=theCookie.length;
		  return unescape(theCookie.substring(ind+cookieName.length+1,ind1));
		}

		function deleteCookie( cookieName ) {
		  if( readCookie( cookieName ) ) {
		    setCookie( cookieName, '', 0, '/' );
		  }
		}

    function statusChangeCallback(response) {
      console.log('statusChangeCallback');
      console.log(response);
    //   // The response object is returned with a status field that lets the
    //   // app know the current login status of the person.
    //   // Full docs on the response object can be found in the documentation
    //   // for FB.getLoginStatus().
      if (response.status === 'connected') {
    //     // Logged into your app and Facebook.
    //     testAPI();
      // } else if (response.status === 'not_authorized') {
    //     // The person is logged into Facebook, but not your app.
    //     document.getElementById('status').innerHTML = 'Please log ' +
    //       'into this app.';
      } else {
    //     // The person is not logged into Facebook, so we're not sure if
    //     // they are logged into this app or not.
    //     document.getElementById('status').innerHTML = 'Please log ' +
    //       'into Facebook.';
      }
    }

    // This function is called when someone finishes with the Login
    // Button.  See the onlogin handler attached to it in the sample
    // code below.
    function checkLoginState() {
      FB.getLoginStatus(function(response) {
        statusChangeCallback(response);
      });
    }

    window.fbAsyncInit = function() {
	    FB.init({
	      appId      : '622776597883723',
	      cookie     : true,  // enable cookies to allow the server to access
	                          // the session
	      xfbml      : true,  // parse social plugins on this page
	      version    : 'v2.8' // use graph api version 2.8
	    });

    // Now that we've initialized the JavaScript SDK, we call
    // FB.getLoginStatus().  This function gets the state of the
    // person visiting this page and can return one of three states to
    // the callback you provide.  They can be:
    //
    // 1. Logged into your app ('connected')
    // 2. Logged into Facebook, but not your app ('not_authorized')
    // 3. Not logged into Facebook and can't tell if they are logged into
    //    your app or not.
    //
    // These three cases are handled in the callback function.

    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });

    };

    // Load the SDK asynchronously
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    // Here we run a very simple test of the Graph API after login is
    // successful.  See statusChangeCallback() for when this call is made.

  </script>
	<div ng-controller="homeCtrl">
        <!-- Navigation -->
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation" id="navBar" ng-show="isLoggedIn">
            <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
									  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">Big Brother</a>
                </div>
								<!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li>
                            <!-- Calls the about page -->
                        </li>
												<
                    </ul>
										<a class="navbar-brand navbar-right" href="#" ng-click="logout()">Logout</a>
                </div>
                <!-- /.navbar-collapse -->
            </div>
            <!-- /.container -->
        </nav>
        <div id="fb-root"></div>
				<!-- Login -->
				<div class="heading" ng-hide="isLoggedIn">
				  <center>
				    <br/><br/><br/>
				      <h1 style="">Big Brother</h1>
				    <br/><br/><br/>
				    <fb:login-button scope="public_profile,email,user_posts,user_photos" onlogin="checkLoginState();">
				    </fb:login-button>
				    <br/>
				  </center>
				</div>
				<!-- Normal Dashboard -->
				<div class="container" ng-show="isLoggedIn">
					<div class="row">
						<div class="col-sm-1"></div>
						<div class="col-sm-10">
							<br/><br/><br/>
							<div class="row">
							    <div class="col-xs-12">
							        <button class="col-xs-12 mbutton" ng-click="getPosts()">Run check</button>
							        <div style="display:none" id="status"></div>
							    </div>
							</div>
							<br/><br/>
							<div class="row" ng-show="started">
								<h3>Filtered Posts </h3>
								<div class="col-sm-12 fpost" ng-repeat="post in filteredPosts">
									{{post.message}}
									<br/>
									<p class="name">
										<a target="_blank" href="https://www.facebook.com/{{post.from.id}}" style="text-decoration:none">
											{{post.from.name}}
										</a>
									</p>
									<hr/>
									<div class="col-sm-4" align="center">
										<a href="#" style="text-decoration:none">
						          <span class="glyphicon glyphicon-ok" ng-click="addReport('true',post.from.id, post.id)"></span>
						        </a>
									</div>
									<div class="col-sm-4" align="center">
										<a href="#" style="text-decoration:none">
											<span class="glyphicon glyphicon-remove" ng-click="addReport('false',post.from.id, post.id)"></span>
										</a>
									</div>
									<div class="col-sm-4" align="center">
										<a target="_blank" href="https://www.facebook.com/{{post.id}}" style="text-decoration:none">
											<span class="glyphicon glyphicon-share-alt"></span>
										</a>
									</div>

								</div>
								<!-- <div class="col-sm-12 fpost" ng-show="filteredPosts.length==0">
									<h3>Woohoo.. You are safe :)</h3>
								</div> -->
							</div>
						</div>
						<div class="col-sm-1"></div>
					</div>
				</div>
	</div>
	<!-- -->
	<footer class="footer" style="background-color:#222;">
    	<div class="container" align="middle">
			<p class="text-muted">
				<p class="white" valign="middle">
          <a class="white" href="http://www.arch.columbia.edu" target="_blank">Made&nbsp; with &nbsp;<a href="#">
          <span class="glyphicon glyphicon-heart"></span>
        </a>

				</p>
			</p>
		</div>
	</footer>
    <!-- Loading scripts at the end -->
	<script src="js/jquery.min.js"></script>
  <script src="bootstrap/js/bootstrap.min.js"></script>
  <script src="js/angular.min.js"></script>
  <script src="js/angular-route.min.js"></script>
  <script src="js/angular-cookies.min.js"></script>
  <script type="text/javascript" src="js/ui-bootstrap-0.9.0.min.js"></script>
  <!-- Angular Scripts -->
	<script src="scripts/app.js" ></script>
  <script src="scripts/text_filter.js" ></script>
  <!-- <script src="scripts/landingCtrl.js" ></script>
  <script src="scripts/aboutCtrl.js" ></script> -->
  <!-- FB SDK -->
  <script src="http://connect.facebook.net/en_US/all.js"></script>
  <!-- End of Scripts -->
</body>
</html>
